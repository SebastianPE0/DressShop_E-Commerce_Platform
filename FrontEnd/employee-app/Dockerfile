# Construcción del frontend
FROM node:20 AS build

WORKDIR /app

# Copiar archivos del proyecto
COPY package.json package-lock.json ./
RUN npm install

COPY . .

# Pasar variables de entorno al build
ARG REACT_APP_BACKEND_URL_CREATE_CATEGORY
ARG REACT_APP_BACKEND_URL_READ_CATEGORY
ARG REACT_APP_BACKEND_URL_DELETE_CATEGORY
ARG REACT_APP_BACKEND_URL_UPDATE_CATEGORY
ENV REACT_APP_BACKEND_URL_CREATE_CATEGORY=$REACT_APP_BACKEND_URL_CREATE_CATEGORY
ENV REACT_APP_BACKEND_URL_READ_CATEGORY=$REACT_APP_BACKEND_URL_READ_CATEGORY
ENV REACT_APP_BACKEND_URL_DELETE_CATEGORY=$REACT_APP_BACKEND_URL_DELETE_CATEGORY
ENV REACT_APP_BACKEND_URL_UPDATE_CATEGORY=$REACT_APP_BACKEND_URL_UPDATE_CATEGORY

RUN npm run build

# ---- Producción ----
FROM nginx:alpine

COPY --from=build /app/dist /usr/share/nginx/html

EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
